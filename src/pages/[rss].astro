---
import { getFilteredPosts } from "$lib/utils";

export async function getStaticPaths({ rss }) {
	// Data Fetching: List all Markdown posts in the repo.
	const allPosts = await Astro.fetchContent("./posts/**/*.md");
	const publishedPosts = getFilteredPosts(allPosts, { isPublished: true });

	// Generate an RSS feed from this collection
	rss({
		// The RSS Feed title, description, and custom metadata.
		title: "Donâ€™s Blog",
		description: "An example blog on Astro",
		customData: `<language>en</language>`,
		// The list of items for your RSS feed, sorted.
		items: publishedPosts.map((item) => ({
			title: item.title,
			description: item.description,
			link: item.url,
			pubDate: new Date(item.publishDate).toISOString(),
		})),
	});

	return [];
}
---
